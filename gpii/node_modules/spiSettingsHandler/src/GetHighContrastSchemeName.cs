/*!
GPII Process Reporter processes bridge -- gpii.processes.

Copyright 2016 Inclusive Design Research Centre, OCAD University

Licensed under the New BSD license. You may not use this file except in
compliance with this License.

You may obtain a copy of the License at
https://github.com/gpii/universal/LICENSE.txt
*/

using System;
using System.Text;
using System.Runtime.InteropServices;

public class Startup
{
    [DllImport("shlwapi.dll", BestFitMapping = false, CharSet = CharSet.Unicode, ExactSpelling = true, SetLastError = false, ThrowOnUnmappableChar = true)]
    public static extern int SHLoadIndirectString(string pszSource, StringBuilder pszOutBuf, int cchOutBuf, IntPtr ppvReserved);

    static void Main(string[] args)
    {
        string param = args[0];
        StringBuilder outBuff = new StringBuilder(4095);

        int result = SHLoadIndirectString(param, outBuff, outBuff.Capacity, IntPtr.Zero);

        Console.OutputEncoding = System.Text.Encoding.UTF8;
        Console.Write(outBuff.ToString());
    }
}
